<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="utf-8"/>
  <meta content="width=device-width, initial-scale=1.0" name="viewport"/>
  <title>REPLYZEAI - Answer Every Open House Lead in 60 Seconds</title>
  <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css" rel="stylesheet"/>
  <style>
    /* Core Animations */
    @keyframes gradientBG { 0% { background-position: 0% 50%; } 50% { background-position: 100% 50%; } 100% { background-position: 0% 50%; } }
    @keyframes floatElement { 0%,100%{transform:translateY(0)rotate(0deg);}50%{transform:translateY(-20px)rotate(3deg);} }
    @keyframes typing { 0%{width:0;}100%{width:100%;} }
    @keyframes pulseCRE {0%{transform:scale(1);opacity:1;}50%{transform:scale(1.05);opacity:0.8;}100%{transform:scale(1);opacity:1;} }
    @keyframes slideDown { from{transform:translateY(-100%);}to{transform:translateY(0);} }
    @keyframes slideUp { to{ transform: translateY(0); opacity: 1;} }
    @keyframes scrollPulse {0%,100%{opacity:1;}50%{opacity:0.3;} }
    @keyframes confettiFall {
      0% { opacity:1; transform: translateY(-100px) rotate(0deg); }
      100% { opacity:0; transform: translateY(100vh) rotate(360deg); }
    }
    @keyframes pulse {
      0%   { box-shadow: 0 0 0 0 rgba(247,37,133,0.4); }
      70%  { box-shadow: 0 0 0 12px rgba(247,37,133,0); }
      100% { box-shadow: 0 0 0 0 rgba(247,37,133,0); }
    }

    /* Base Styles */
    *{margin:0;padding:0;box-sizing:border-box;font-family:'Segoe UI',Tahoma,Geneva,Verdana,sans-serif;}
    body{background:linear-gradient(-45deg,#0a192f,#112240,#1a2f4b,#233554);background-size:400% 400%;animation:gradientBG 25s ease infinite;color:#fff;overflow-x:hidden;perspective:1000px;}
    .progress-bar{height:4px;background:#64ffda;position:fixed;top:0;left:0;z-index:10000;transition:width .4s cubic-bezier(.22,.61,.36,1);}

    /* Navigation */
    .nav{padding:1.5rem 8%;display:flex;justify-content:space-between;align-items:center;background:rgba(10,25,47,.9);backdrop-filter:blur(15px);position:fixed;width:100%;z-index:1000;transition:all .4s;transform:translateY(-100%);animation:slideDown .8s cubic-bezier(.23,1,.32,1) forwards;border-bottom:1px solid rgba(100,255,218,.1);}
    .logo{font-size:2.2rem;font-weight:700;background:linear-gradient(45deg,#64ffda,#8affdf);-webkit-background-clip:text;-webkit-text-fill-color:transparent;text-shadow:0 0 25px rgba(100,255,218,.3);letter-spacing:-.5px;}
    .nav-links{display:flex;gap:2rem;}
    .nav-links a{color:#8892b0;text-decoration:none;font-weight:500;transition:all .3s;position:relative;}
    .nav-links a:hover{color:#64ffda;}
    .nav-links a::after{content:'';position:absolute;bottom:-5px;left:0;width:0;height:2px;background:#64ffda;transition:width .3s;}
    .nav-links a:hover::after{width:100%;}
    .cta-button{display:inline-flex;align-items:center;justify-content:center;padding:.9rem 2rem;border-radius:50px;font-weight:700;text-decoration:none;transition:all .4s cubic-bezier(.23,1,.32,1);position:relative;overflow:hidden;border:2px solid #64ffda;background:linear-gradient(135deg,#64ffda 0%,#52d1b8 100%);color:#0a192f;box-shadow:0 4px 25px rgba(100,255,218,.3);transform:translateY(0);font-size:1rem;}
    .cta-button:hover{transform:translateY(-3px);box-shadow:0 8px 35px rgba(100,255,218,.5);background:linear-gradient(135deg,#73ffe1 0%,#61e8cf 100%);}
    .cta-button:active{transform:translateY(1px);box-shadow:0 2px 15px rgba(100,255,218,.2);}
    .cta-button::before{content:'';position:absolute;top:0;left:-100%;width:200%;height:100%;background:linear-gradient(90deg,transparent,rgba(255,255,255,.2),transparent);transition:.4s;}
    .cta-button:hover::before{left:100%;}

    /* Hero Section - Updated */
    .hero{padding:12rem 8% 6rem;text-align:center;position:relative;overflow:hidden;min-height:80vh;display:flex;flex-direction:column;justify-content:center;align-items:center;}
    .hero h1{font-size:3.5rem;margin-bottom:1.5rem;line-height:1.1;max-width:900px;background:linear-gradient(45deg,#64ffda,#8affdf);-webkit-background-clip:text;-webkit-text-fill-color:transparent;text-shadow:0 0 25px rgba(100,255,218,.3);}
    .hero-subhead{font-size:1.4rem;color:#8892b0;margin-bottom:3rem;max-width:700px;line-height:1.6;font-weight:400;}
    
    /* Proof Section */
    .proof-section {padding:5rem 8%;background:rgba(10,25,47,0.6);text-align:center;}
    .proof-container {max-width:1000px;margin:0 auto;display:flex;flex-direction:column;align-items:center;}
    .proof-image {width:100%;max-width:800px;border-radius:12px;border:1px solid rgba(100,255,218,0.2);box-shadow:0 15px 30px rgba(10,25,47,0.5);margin:2rem 0;}
    
    /* Trust Elements */
    .trust-logos {display:flex;justify-content:center;gap:2rem;flex-wrap:wrap;margin:3rem 0;}
    .trust-logo {height:60px;opacity:0.7;transition:opacity 0.3s;filter:grayscale(1) brightness(2);}
    .trust-logo:hover {opacity:1;filter:none;}
    
    /* Security Bar */
    .security-bar {background:rgba(16,36,64,0.6);padding:1.5rem;border-radius:12px;margin:2rem 0;border:1px solid rgba(100,255,218,0.2);display:flex;align-items:center;justify-content:center;gap:1.5rem;flex-wrap:wrap;}
    .security-item {display:flex;align-items:center;gap:0.5rem;color:#64ffda;font-size:0.9rem;}
    
    /* Interactive Demo Section */
    .interactive-demo {padding:5rem 8%;background:rgba(10,25,47,0.4);}
    .demo-container {background:rgba(16,36,64,0.8);border-radius:15px;padding:2rem;border:1px solid rgba(100,255,218,0.2);margin:2rem auto;max-width:800px;}
    .demo-header {display:flex;justify-content:space-between;align-items:center;margin-bottom:1rem;padding-bottom:1rem;border-bottom:1px solid rgba(100,255,218,0.1);}
    .demo-title {color:#64ffda;font-size:1.2rem;}
    .demo-input {width:100%;min-height:120px;background:rgba(10,25,47,0.7);border:1px solid rgba(100,255,218,0.3);border-radius:8px;padding:1.5rem;color:#fff;margin-bottom:1.5rem;font-size:1rem;resize:vertical;}
    .demo-input:focus {outline:none;border-color:#64ffda;box-shadow:0 0 0 3px rgba(100,255,218,.2);}
    
    /* Trial Counter */
    .trial-counter{background:rgba(100,255,218,0.1);border-radius:50px;padding:.8rem 1.5rem;display:inline-flex;align-items:center;gap:.8rem;margin-bottom:1.5rem;font-size:1rem;border:1px solid rgba(100,255,218,0.2);}
    .counter-number{font-weight:700;color:#64ffda;font-size:1.2rem;}
    
    /* Response Container */
    .response-container {display:none;max-width:800px;margin:2rem auto 0;}
    .response-header {display:flex;justify-content:space-between;align-items:center;margin-bottom:1rem;}
    .response-title {color:#64ffda;font-size:1.2rem;}
    .response-content {background:rgba(10,25,47,0.7);border-radius:8px;padding:1.5rem;color:#8892b0;line-height:1.6;border:1px solid rgba(100,255,218,0.2);}
    
    /* Trial Section */
    .trial-section {padding:5rem 8%;background:rgba(10,25,47,0.6);}
    .trial-container {max-width:800px;margin:0 auto;text-align:center;}
    .trial-card {background:rgba(16,36,64,0.8);border-radius:15px;padding:3rem;border:1px solid rgba(100,255,218,0.2);}
    .trial-form {margin-top:2rem;}
    .form-group {margin-bottom:1.5rem;text-align:left;}
    .form-group label {display:block;margin-bottom:.5rem;color:#64ffda;}
    .form-group input {width:100%;padding:1rem;border-radius:8px;border:1px solid rgba(100,255,218,0.3);background:rgba(10,25,47,0.7);color:#fff;font-size:1rem;}
    .form-group input:focus {outline:none;border-color:#64ffda;box-shadow:0 0 0 3px rgba(100,255,218,.2);}
    
    /* Two-Line RSVP Section */
    .rsvp-section {padding:5rem 8%;background:rgba(10,25,47,0.4);}
    
    /* Live Chat */
    .live-chat {position:fixed;bottom:2rem;right:2rem;z-index:1000;}
    .chat-button {width:60px;height:60px;border-radius:50%;background:linear-gradient(135deg,#64ffda 0%,#52d1b8 100%);color:#0a192f;display:flex;align-items:center;justify-content:center;font-size:1.5rem;box-shadow:0 4px 25px rgba(100,255,218,.3);cursor:pointer;transition:all .3s;}
    .chat-button:hover {transform:translateY(-3px);box-shadow:0 8px 35px rgba(100,255,218,.5);}
    
    /* Stats Container */
    .stats-container{display:flex;justify-content:center;gap:3rem;margin-top:4rem;flex-wrap:wrap;}
    .stat-card{text-align:center;padding:1.5rem;min-width:180px;}
    .stat-number{font-size:3.5rem;font-weight:700;background:linear-gradient(45deg,#64ffda,#8affdf);-webkit-background-clip:text;-webkit-text-fill-color:transparent;margin-bottom:.5rem;}
    .stat-label{color:#8892b0;font-size:1.1rem;text-transform:uppercase;letter-spacing:1px;}
    
    /* Updated Urgency Banner */
    .urgency-banner-updated {background:linear-gradient(90deg, #f72585 0%, #b5179e 100%);padding:12px 0;text-align:center;font-weight:600;position:relative;overflow:hidden;}
    .urgency-banner-updated span {animation:pulse 2s infinite;}
    
    /* Modal */
    .modal {display:none;position:fixed;z-index:2000;left:0;top:0;width:100%;height:100%;background-color:rgba(10,25,47,0.9);}
    .modal-content {background-color:rgba(16,36,64,0.95);margin:10% auto;padding:2rem;border:1px solid rgba(100,255,218,0.3);border-radius:15px;width:90%;max-width:500px;position:relative;}
    .close-modal {color:#8892b0;float:right;font-size:1.5rem;font-weight:bold;cursor:pointer;}
    .close-modal:hover {color:#64ffda;}
    
    /* Form message styles */
    .form-message {
      padding: 10px;
      border-radius: 8px;
      margin: 15px 0;
      text-align: center;
      display: none;
    }
    
    .form-error {
      background: rgba(255, 96, 92, 0.1);
      border: 1px solid rgba(255, 96, 92, 0.3);
      color: #ff605c;
    }
    
    .form-success {
      background: rgba(0, 202, 78, 0.1);
      border: 1px solid rgba(0, 202, 78, 0.3);
      color: #00ca4e;
    }
    
    /* Responsive adjustments */
    @media (max-width: 768px) {
      .hero h1 {font-size:2.5rem;}
      .hero-subhead {font-size:1.1rem;}
      .trust-logo {height:40px;}
      .security-bar {flex-direction:column;gap:1rem;}
      .nav-links {display: none;}
      .stats-container {gap: 1.5rem;}
      .stat-card {min-width: 140px; padding: 1rem;}
      .stat-number {font-size: 2.5rem;}
      .trial-card {padding: 2rem;}
      .modal-content {margin: 20% auto; width: 95%;}
    }
  </style>
</head>
<body>
  <div class="progress-bar" id="progressBar"></div>
  
  <!-- Updated Urgency Banner with Dynamic Counter - Enhanced FOMO -->
  <div class="urgency-banner-updated">
    <span>⏰ <strong>Warning:</strong> Personal Onboarding: Only <span id="slots-counter">5</span> Spots Left This Week - Agents are grabbing these!</span>
  </div>
  
  <nav class="nav">
    <div class="logo">REPLYZEAI</div>
    <div class="nav-links">
      <a href="#how-it-works">How It Works</a>
      <a href="#proof">Proof</a>
      <a href="#trial">Free Trial</a>
      <a href="#testimonials">Testimonials</a>
    </div>
    <a class="cta-button" href="#trial">Get My Free Trial Now</a>
  </nav>
  
  <!-- Refocused Hero Section with Stronger Hook -->
  <section class="hero">
    <h1>Stop Losing Open House Leads to Faster Agents</h1>
    <p class="hero-subhead">REPLYZEAI helps solo agents like you respond to <strong>every lead in 60 seconds</strong> - turning more "maybe's" into booked appointments while you focus on closing deals.</p>
    <a class="cta-button" href="#demo">
      <i class="fas fa-robot"></i> See How It Works For Your Business
    </a>
    
    <div class="stats-container">
      <div class="stat-card">
        <div class="stat-number">98%</div>
        <div class="stat-label">More Booked Tours</div>
      </div>
      <div class="stat-card">
        <div class="stat-number">17+</div>
        <div class="stat-label">Extra Appointments/Month</div>
      </div>
      <div class="stat-card">
        <div class="stat-number">3h</div>
        <div class="stat-label">Saved Daily</div>
      </div>
    </div>
  </section>
  
  <!-- Proof Section with Enhanced Social Proof -->
  <section class="proof-section" id="proof">
    <h2 style="font-size:2.5rem;color:#64ffda;margin-bottom:1.5rem;">How Michael Chen Booked 17 Tours From One Open House (Without Lifting a Finger)</h2>
    <p style="text-align:center;color:#8892b0;max-width:800px;margin:0 auto 2rem;line-height:1.6;">
      "Before REPLYZEAI, I was missing 60% of open house leads. Now I'm converting strangers into booked appointments while I sleep." - Michael Chen, Solo Agent
    </p>
    
    <div class="proof-container">
      <img src="michel_chen.webp" alt="Michael Chen's success story" class="proof-image">
      
      <div class="security-bar">
        <div class="security-item">
          <i class="fas fa-shield-alt"></i>
          <span>SOC 2 Compliant</span>
        </div>
        <div class="security-item">
          <i class="fas fa-lock"></i>
          <span>Bank-Level Encryption</span>
        </div>
        <div class="security-item">
          <i class="fas fa-user-shield"></i>
          <span>GDPR Compliant</span>
        </div>
        <div class="security-item">
          <i class="fas fa-database"></i>
          <span>MLS Integration Ready</span>
        </div>
      </div>
    </div>
  </section>
  
  <!-- Interactive Demo Section with Three Yes Ladder Approach -->
  <section class="interactive-demo" id="demo">
    <h2 style="font-size:2.5rem;color:#64ffda;margin-bottom:1.5rem;text-align:center;">See Exactly How REPLYZEAI Works For YOUR Leads</h2>
    <p style="text-align:center;color:#8892b0;max-width:800px;margin:0 auto 3rem;line-height:1.6;">
      Tired of leads going cold while you're busy? See how our AI captures and converts leads in real-time.
    </p>
    
    <div class="demo-container">
      <div class="demo-header">
        <div class="demo-title">1. Paste Your Last Lead Message Here</div>
        <div style="color: #64ffda; font-size: 0.9rem;">Watch REPLYZEAI craft the perfect response</div>
      </div>
      
      <!-- Added trial counter with enhanced scarcity -->
      <div class="trial-counter"><i class="fas fa-gift"></i> <strong>FREE DEMO:</strong> Only <span class="counter-number" id="ai-counter">3</span> responses left today</div>
      
      <textarea class="demo-input" id="demo-input" placeholder="Paste a lead message here...">Hi, I saw your sign at 123 Elm St. Is the open house still this Sunday? What time? - Jennifer</textarea>
      <button class="cta-button" style="width: 100%;" id="generate-btn">
        <i class="fas fa-robot"></i> See My AI Response Now
      </button>
    </div>
    
    <div class="response-container" id="response-container">
      <div class="demo-header">
        <div class="demo-title">2. Your Personalized AI Response</div>
        <div style="color: #64ffda; font-size: 0.9rem;">Proven to increase appointments by 42%</div>
      </div>
      <div class="response-content">
        <div id="ai-response">Generating your response...</div>
      </div>
      <div style="display: flex; gap: 10px; margin-top: 1.5rem;">
        <button class="cta-button" style="flex: 1;" onclick="copyResponse()">
          <i class="fas fa-copy"></i> Copy & Use This Response
        </button>
        <button class="cta-button" style="flex: 1;" onclick="location.href='#trial'">
          <i class="fas fa-rocket"></i> 3. Get Your FREE Trial Now
        </button>
      </div>
    </div>
  </section>
  
  <!-- Free Trial Section with Outcome-Focused Messaging -->
  <section class="trial-section" id="trial">
    <div class="trial-container">
      <h2 style="font-size:2.5rem;color:#64ffda;margin-bottom:1rem;">Ready to Stop Losing Leads to Faster Agents?</h2>
      <p style="color:#8892b0;max-width:600px;margin:0 auto 2rem;line-height:1.6;">
        Join 3,247+ agents who booked <strong>17+ more appointments per month</strong> without hiring additional staff.
      </p>
      
      <div class="trial-card">
        <div style="display:grid;grid-template-columns:repeat(auto-fit, minmax(250px, 1fr));gap:2rem;margin-bottom:2rem;">
          <div>
            <h3 style="color:#64ffda;margin-bottom:1rem;">You'll Get REAL Results:</h3>
            <ul style="color:#8892b0;list-style-type:none;">
              <li style="margin-bottom:0.5rem;">
                <i class="fas fa-check" style="color:#64ffda;margin-right:0.5rem;"></i>
                <strong>Convert 40% more leads</strong> into appointments
              </li>
              <li style="margin-bottom:0.5rem;">
                <i class="fas fa-check" style="color:#64ffda;margin-right:0.5rem;"></i>
                <strong>Save 3+ hours daily</strong> on lead follow-up
              </li>
              <li style="margin-bottom:0.5rem;">
                <i class="fas fa-check" style="color:#64ffda;margin-right:0.5rem;"></i>
                <strong>Never lose a lead</strong> to slow response again
              </li>
              <li style="margin-bottom:0.5rem;">
                <i class="fas fa-check" style="color:#64ffda;margin-right:0.5rem;"></i>
                <strong>Compete with teams</strong> as a solo agent
              </li>
            </ul>
          </div>
          <div>
            <h3 style="color:#64ffda;margin-bottom:1rem;">What Solo Agents Say:</h3>
            <ul style="color:#8892b0;list-style-type:none;">
              <li style="margin-bottom:0.5rem;font-style:italic;">
                <i class="fas fa-quote-left" style="color:#64ffda;margin-right:0.5rem;"></i>
                "Booked 4 extra deals my first month using REPLYZEAI"
              </li>
              <li style="margin-bottom:0.5rem;font-style:italic;">
                <i class="fas fa-quote-left" style="color:#64ffda;margin-right:0.5rem;"></i>
                "Finally competing with teams that have 5 assistants"
              </li>
              <li style="margin-bottom:0.5rem;font-style:italic;">
                <i class="fas fa-quote-left" style="color:#64ffda;margin-right:0.5rem;"></i>
                "Worth every penny - paid for itself in one open house"
              </li>
              <li style="margin-bottom:0.5rem;font-style:italic;">
                <i class="fas fa-quote-left" style="color:#64ffda;margin-right:0.5rem;"></i>
                "My response time went from hours to 60 seconds"
              </li>
            </ul>
          </div>
        </div>
        
        <!-- Updated Form with Supabase Integration -->
        <form class="trial-form" id="trial-form">
          <div id="form-message" class="form-message"></div>
          
          <div class="form-group">
            <label for="name">Your Name</label>
            <input type="text" id="name" placeholder="What should we call you?" required>
          </div>
          
          <div class="form-group">
            <label for="email">Your Best Email</label>
            <input type="email" id="email" placeholder="Where should we send your login?" required>
          </div>
          
          <div class="form-group">
            <label for="password">Create Secure Password</label>
            <input type="password" id="password" placeholder="Minimum 6 characters" required minlength="6">
          </div>
          
          <button class="cta-button" style="width: 100%; padding: 1.2rem; margin-top: 1rem;" type="submit" id="signup-button">
            <i class="fas fa-rocket"></i> Start My FREE 30-Day Trial Now
          </button>
          <p style="color:#8892b0;font-size:0.9rem;margin-top:1rem;">
            <strong>No credit card required</strong> • Join 3,247+ agents • Cancel anytime
          </p>
        </form>
      </div>
    </div>
  </section>
  
  <!-- Two-Line RSVP Script Section with Enhanced Benefit Language -->
  <section class="rsvp-section">
    <h2 style="font-size:2.5rem;color:#64ffda;margin-bottom:1.5rem;text-align:center;">Get Your FREE "Two-Line RSVP" Script (Proven 42% Higher Conversion)</h2>
    <p style="text-align:center;color:#8892b0;max-width:800px;margin:0 auto 2rem;line-height:1.6;">
      Used by top-producing agents to convert more leads into confirmed appointments - even without AI.
    </p>
    
    <div style="background:rgba(16,36,64,0.6);border-radius:15px;padding:2.5rem;border:1px solid rgba(100,255,218,0.2);max-width:800px;margin:0 auto;">
      <div style="background:rgba(10,25,47,0.8);padding:1.5rem;border-radius:10px;border:1px solid rgba(100,255,218,0.1);">
        <p style="color:#8892b0;font-style:italic;line-height:1.7;">
          "Hi [Name], thanks for your interest in our open house at [Address] this weekend! We'd love to have you. Please let us know what time works best for you, and we'll send over all the details. Looking forward to meeting you!"
        </p>
      </div>
      <p style="text-align:center;color:#8892b0;margin-top:1.5rem;">
        <strong>Pro Tip:</strong> Agents using this script report 42% higher RSVP rates compared to generic responses.
      </p>
      <button class="cta-button" style="margin-top: 1.5rem; width: 100%;" onclick="downloadScriptGuide()">
        <i class="fas fa-download"></i> Download My FREE Script Guide Now
      </button>
    </div>
  </section>

  <!-- Email Capture Modal -->
  <div id="email-modal" class="modal">
    <div class="modal-content">
      <span class="close-modal" onclick="closeModal()">&times;</span>
      <h2 style="color:#64ffda;margin-bottom:1rem;">Get Your Free Script Guide</h2>
      <p style="color:#8892b0;margin-bottom:1.5rem;">Enter your email to download the complete Two-Line RSVP script guide.</p>
      <form id="email-form">
        <div class="form-group">
          <label for="modal-email">Email Address</label>
          <input type="email" id="modal-email" placeholder="Your email address" required>
        </div>
        <button class="cta-button" style="width: 100%;" type="submit">
          <i class="fas fa-download"></i> Download Now
        </button>
      </form>
    </div>
  </div>

  <!-- Live Chat -->
  <div class="live-chat">
    <div class="chat-button" onclick="openCalendly()">
      <i class="fas fa-calendar-alt"></i>
    </div>
  </div>

  <!-- Include Supabase JS -->
  <script src="https://unpkg.com/@supabase/supabase-js@2"></script>
  
  <script>
    // Initialize Supabase first to avoid reference errors
    const initializeApp = function() {
      // Supabase Configuration
      const supabaseUrl = 'https://skxzfkudduqrubtgtodp.supabase.co';
      const supabaseKey = 'eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhbmFzZSIsInJlZiI6InNreHpma3VkZHVxcnVidGd0b2RwIiwicm9sZSI6ImFub24iLCJpYXQiOjE3NDU1ODAwNzMsImV4cCI6MjA2MTE1NjA3M30.Wj3V5-swysAz8xAbA4lKmo-NNu_mv1UW_X4BgFNq0ag';
      window.supabase = supabase.createClient(supabaseUrl, supabaseKey);
      
      // Now initialize the rest of the application
      initApplication();
    };

    // Main application initialization
    const initApplication = function() {
      // Cookie-based rate limiting functions (from demooff.html)
      function setCookie(name, value, days) {
        let expires = "";
        if (days) {
          const date = new Date();
          date.setTime(date.getTime() + (days * 24 * 60 * 60 * 1000));
          expires = "; expires=" + date.toUTCString();
        }
        document.cookie = name + "=" + (value || "") + expires + "; path=/; SameSite=Lax";
      }

      function getCookie(name) {
        const nameEQ = name + "=";
        const ca = document.cookie.split(';');
        for(let i = 0; i < ca.length; i++) {
          let c = ca[i];
          while (c.charAt(0) === ' ') c = c.substring(1, c.length);
          if (c.indexOf(nameEQ) === 0) return c.substring(nameEQ.length, c.length);
        }
        return null;
      }

      // Initialize rate limiting for AI responses
      let aiCount;

      function initRateLimiting() {
        const trialsCookie = getCookie('free_trials');
        
        if (trialsCookie) {
          const trials = JSON.parse(trialsCookie);
          aiCount = trials.ai;
        } else {
          // First visit - set initial values
          aiCount = 3;
          updateTrialsCookie();
        }
        
        // Update UI
        document.getElementById('ai-counter').textContent = aiCount;
      }

      function updateTrialsCookie() {
        const trials = {
          ai: aiCount,
        };
        setCookie('free_trials', JSON.stringify(trials), 7); // Expires in 7 days
      }

      // Initialize rate limiting on page load
      initRateLimiting();

      // Initialize variables
      let slotsLeft = 5;
      
      // Update urgency counter dynamically
      function updateUrgencyCounter() {
        // Randomly decrease slots (but not below 0)
        if (slotsLeft > 0 && Math.random() < 0.3) {
          slotsLeft--;
          document.getElementById('slots-counter').textContent = slotsLeft;
        }
        
        // Update message based on slots left
        const urgencyBanner = document.querySelector('.urgency-banner-updated span');
        if (slotsLeft <= 2) {
          urgencyBanner.innerHTML = `⏰ Mark's Onboarding: <span id="slots-counter">${slotsLeft}</span> Spots Left - Almost Full!`;
        }
      }
      
      // Set up interval to update urgency counter
      setInterval(updateUrgencyCounter, 30000); // Update every 30 seconds
      
      // Generate AI response using the actual API
      async function generateResponse() {
        const input = document.getElementById('demo-input').value.trim();
        const leadId = window.currentLeadId;
        const responseContainer = document.getElementById('response-container');
        const aiResponse = document.getElementById('ai-response');
        const generateBtn = document.getElementById('generate-btn');
        
        if (!input) {
          alert('Please paste a lead message or use our example.');
          return;
        }
        
        // Check if user has demo tries left using cookie-based rate limiting
        if (aiCount <= 0) {
          alert('No more free AI responses. Please sign up for a full account.');
          responseContainer.style.display = 'none';
          document.querySelector('#trial').scrollIntoView({ behavior: 'smooth' });
          return;
        }
        
        // Decrement count and update cookie
        aiCount--;
        updateTrialsCookie();
        document.getElementById('ai-counter').textContent = aiCount;
        
        // Show loading state
        generateBtn.innerHTML = '<i class="fas fa-spinner fa-spin"></i> Generating...';
        generateBtn.disabled = true;
        aiResponse.innerHTML = '<i class="fas fa-spinner fa-spin"></i> Generating your response...';
        responseContainer.style.display = 'block';
        
        try {
          // Make API call to the actual endpoint
          const response = await fetch('https://website-1-f6l8.onrender.com/api/generate-reply-prompt', {
            method: 'POST',
            headers: {
              'Content-Type': 'application/json',
            },
            body: JSON.stringify({ prompt: input })
          });
          
          if (!response.ok) {
            throw new Error('API request failed');
          }
          
          const data = await response.json();
          aiResponse.textContent = data.reply || data;
          
          // Record AI usage if we have a lead ID
          if (leadId) {
            try {
              await fetch('https://website-1-f6l8.onrender.com/api/record-ai-usage', {
                method: 'POST',
                headers: { 'Content-Type': 'application/json' },
                body: JSON.stringify({ lead_id: leadId })
              });
            } catch (error) {
              console.error('Error recording AI usage:', error);
            }
          }
          
        } catch (error) {
          console.error('Error generating response:', error);
          // Fallback response if API fails
          aiResponse.textContent = "Hi there! Thanks for your message. I'd be happy to help you with your real estate needs. When were you thinking of coming by for a viewing?";
        } finally {
          // Restore button state
          generateBtn.innerHTML = '<i class="fas fa-robot"></i> Generate AI Response';
          generateBtn.disabled = false;
          
          // Scroll to response
          responseContainer.scrollIntoView({ behavior: 'smooth', block: 'start' });
        }

        // If out of tries, show message after a delay
        if (aiCount === 0) {
          setTimeout(() => {
            alert("You've used your free AI responses! Sign up now for unlimited access.");
            document.querySelector('#trial').scrollIntoView({ behavior: 'smooth' });
          }, 1000);
        }
      }
      
      // Copy response to clipboard
      function copyResponse() {
        const responseText = document.getElementById('ai-response').textContent;
        navigator.clipboard.writeText(responseText).then(() => {
          alert('Response copied to clipboard!');
        });
      }
      
      // Open Calendly
      function openCalendly() {
        alert('Opening scheduling page...');
        // In a real implementation, this would open a Calendly modal
        // window.Calendly.initPopupWidget({url: 'https://calendly.com/your-username'});
      }
      
      // Form submission handler
      document.getElementById('trial-form').addEventListener('submit', async function(e) {
        e.preventDefault();
        
        const formMessage = document.getElementById('form-message');
        const signupButton = document.getElementById('signup-button');
        const originalButtonText = signupButton.innerHTML;
        
        // Get form values
        const name = document.getElementById('name').value;
        const email = document.getElementById('email').value;
        const password = document.getElementById('password').value;
        
        // Validate password length
        if (password.length < 6) {
          formMessage.textContent = 'Password must be at least 6 characters long';
          formMessage.className = 'form-message form-error';
          formMessage.style.display = 'block';
          return;
        }
        
        // Show loading state
        signupButton.disabled = true;
        signupButton.innerHTML = '<i class="fas fa-spinner fa-spin"></i> Creating Account...';
        formMessage.style.display = 'none';
        
        try {
          // Create user with Supabase
          const { data, error } = await window.supabase.auth.signUp({
            email,
            password,
            options: {
              data: {
                full_name: name,
                user_type: 'real_estate_agent'
              }
            }
          });
          
          if (error) throw error;
          
          // Show success message
          formMessage.textContent = 'Account created successfully! Please check your email to verify your account.';
          formMessage.className = 'form-message form-success';
          formMessage.style.display = 'block';
          
          // Reset form
          this.reset();
          
          // Reset trial counters
          aiCount = 3;
          updateTrialsCookie();
          document.getElementById('ai-counter').textContent = '3';
          
          // Redirect after successful signup (optional)
           window.location.href = '/signin?user_id=' + data.user.id;
          
        } catch (error) {
          console.error('Signup error:', error);
          formMessage.textContent = error.message.includes('already registered') 
            ? 'Email already registered. Try logging in or resetting your password.'
            : error.message;
          formMessage.className = 'form-message form-error';
          formMessage.style.display = 'block';
        } finally {
          // Restore button state
          signupButton.disabled = false;
          signupButton.innerHTML = originalButtonText;
        }
      });
      
      // Download script guide
      function downloadScriptGuide() {
        // Show email capture modal instead of directly downloading
        document.getElementById('email-modal').style.display = 'block';
      }
      
      // Close modal
      function closeModal() {
        document.getElementById('email-modal').style.display = 'none';
      }
      
      // Email form submission
      document.getElementById('email-form').addEventListener('submit', function(e) {
        e.preventDefault();
        const email = document.getElementById('modal-email').value;
        
        // Here you would typically send the email to your backend
        console.log('Email captured for download:', email);
        
        // Create and trigger download
        const scriptContent = `Two-Line RSVP Script Guide\n\nPrimary Script:\n"Hi [Name], thanks for your interest in our open house at [Address] this weekend! We'd love to have you. Please let us know what time works best for you, and we'll send over all the details. Looking forward to meeting you!"\n\nVariations:\n1. For warmer leads: "Hi [Name], great meeting you at [Address]! As discussed, we're having the open house this weekend. Which day works better for you - Saturday or Sunday?"\n2. For follow-up: "Hi [Name], just following up on your interest in [Address]. We've had lots of interest, so let me know if you'd like me to save you a specific time slot!"\n\nTips:\n- Always personalize with the property address\n- Send within 1 hour of lead inquiry\n- Include specific time options when possible`;
        
        const blob = new Blob([scriptContent], { type: 'text/plain' });
        const url = window.URL.createObjectURL(blob);
        const a = document.createElement('a');
        a.href = url;
        a.download = 'ReplyzeAI-Two-Line-RSVP-Script.txt';
        document.body.appendChild(a);
        a.click();
        a.remove();
        window.URL.revokeObjectURL(url);
        
        // Close modal
        closeModal();
      });
      
      // Close modal if clicked outside
      window.onclick = function(event) {
        const modal = document.getElementById('email-modal');
        if (event.target == modal) {
          closeModal();
        }
      };
      
      // Attach event listener to generate button
      document.getElementById('generate-btn').addEventListener('click', generateResponse);
    };
    
    // Start the application initialization
    initializeApp();
  </script>
<!---------------------------------------------------------------------------------------------------------->
  <!-- Add this script to demo2.html to check for tracking parameters -->
 <script>
    document.addEventListener('DOMContentLoaded', function() {
        // Check if there's a lead_id in the URL parameters (from tracked links)
        const urlParams = new URLSearchParams(window.location.search);
        const leadId = urlParams.get('lead_id');
        const campaignId = urlParams.get('campaign_id');

        if (leadId) {
            // Store the lead ID for tracking
            window.currentLeadId = leadId;
            
            // Set the hidden field value
            document.getElementById('lead-id').value = leadId;
            
            // Optional: You can fetch lead details if needed for personalization
            fetch(`https://website-1-f6l8.onrender.com/api/leads/${leadId}`)
                .then(response => response.json())
                .then(data => {
                    if (data.ok && data.lead) {
                        // You could use this data for personalization if desired
                        console.log('Lead details:', data.lead);
                    }
                })
                .catch(error => {
                    console.error('Error fetching lead data:', error);
                });
        }
    });
</script>

<!-- Add a hidden field to store the lead ID -->
<input type="hidden" id="lead-id" name="lead_id">
  <!-------------------------------------------------------------------------------------->
  
  <script>
  function copyResponse() {
    const responseEl = document.getElementById("ai-response");
    if (!responseEl) return;

    const text = responseEl.innerText;

    navigator.clipboard.writeText(text).then(() => {
      alert("Response copied to clipboard!");
    }).catch(err => {
      console.error("Failed to copy: ", err);
    });
  }
</script>

</body>
</html>
